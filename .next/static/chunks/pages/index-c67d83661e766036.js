(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return c(1870)}])},1870:function(c,b,a){"use strict";a.r(b),a.d(b,{"__N_SSP":function(){return o},default:function(){return p}});var d=a(6042),e=a(9396),f=a(797),g=a(5893),h=a(7294),i=a(1163),j=a(9473);function k(a){var c=a.router,d=a.page,e=a.sort,f=a.category,g=a.search,h=c.pathname,b=c.query;d&&(b.page=d),e&&(b.sort=e),f&&(b.category=f),g&&(b.search=g),c.push({pathname:h,query:b})}var l=a(5014),m=function(i){var f,h,a=i.product,c=(0,j.v9)(function(a){return a}),k=c.cart,b=c.auth,m=c.products,n=(0,j.I0)(),o=function(a){n((0,l.$G)(m,a._id,(0,e.Z)((0,d.Z)({},a),{checked:!a.checked}),"ADD_PRODUCT"))};return(0,g.jsxs)("div",{className:"card",style:{position:"relative",width:"18rem"},children:[b.user&&"admin"===b.user.role&&(0,g.jsx)("span",{children:(0,g.jsx)("input",{type:"checkbox",checked:a.checked,style:{position:"absolute"},onChange:function(){return o(a)}})}),(0,g.jsx)("img",{className:"card-img-top",src:a.images&&a.images[0].url,alt:"Card image cap"}),(0,g.jsxs)("div",{className:"card-body",children:[(0,g.jsxs)("div",{className:"stock d-flex justify-content-between",children:[(0,g.jsxs)("h6",{className:"text-danger",children:[a.price,"$"]}),(0,g.jsxs)("h6",{className:"text-danger",children:[a.inStock>0?"inStock : "+a.inStock:"out of stock"," | sold: ",a.sold]})]}),(0,g.jsx)("h5",{className:"card-title text-capitalize",children:a.title}),(0,g.jsx)("p",{className:"card-text",children:a.description}),(0,g.jsx)("div",{className:"d-flex justify-content-between",children:b.user&&"admin"===b.user.role?(f=a,(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("a",{href:"/create/".concat(f._id),className:"flex-fill w-100 mx-1 btn btn-primary",children:"Edit"}),(0,g.jsx)("button",{className:" flex-fill btn w-100 btn-danger mx-1","data-toggle":"modal","data-target":"#exampleModal",onClick:function(){return n({type:"MODAL",payload:{title:f.title,item:f,auth:b,actionType:"deleteProduct"}})},children:"Delete"})]})):(h=a,(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("a",{href:"/products/".concat(h._id),className:"flex-fill w-100 mx-1 btn btn-primary",children:"view"}),(0,g.jsx)("button",{onClick:function(){return n((0,l.Xq)(h,k))},className:" flex-fill btn w-100 btn-success mx-1",children:"buy"})]}))})]})]})};function n(c){var d=c.categories,e=(0,i.useRouter)(),a=(0,h.useState)(e.query.category||""),f=a[0],l=a[1],b=(0,h.useState)(""),j=b[0],m=b[1];return(0,h.useEffect)(function(){k({router:e,search:j?j.toLowerCase():"all"})},[j]),(0,g.jsxs)("div",{className:"filter my-2 d-flex",children:[(0,g.jsxs)("div",{className:"input-group w-25",children:[(0,g.jsx)("div",{className:"input-group-prepend",children:(0,g.jsx)("span",{className:"input-group-text",children:"categroy"})}),(0,g.jsxs)("select",{value:f,className:"form-control",onChange:function(a){l(a.target.value),k({router:e,category:a.target.value})},children:[(0,g.jsx)("option",{value:"all",children:"All Products"}),d.map(function(a){return(0,g.jsx)("option",{value:a._id,children:a.name},a._id)})]})]}),(0,g.jsx)("input",{type:"text",placeholder:"search...",name:"title",className:"form-control w-50",onChange:function(a){return m(a.target.value)}}),(0,g.jsxs)("select",{className:"form-control w-25",onChange:function(a){k({router:e,sort:a.target.value})},children:[(0,g.jsx)("option",{value:"-createdAt",children:"newest"}),(0,g.jsx)("option",{value:"oldest",children:"oldest"}),(0,g.jsx)("option",{value:"-sold",children:"best sell"}),(0,g.jsx)("option",{value:"price",children:"price low-high"}),(0,g.jsx)("option",{value:"-price",children:"price high-low"})]})]})}var o=!0;function p(c){var s=c.productsList,t=c.more,b=(0,j.v9)(function(a){return a}),u=b.categories,y=b.auth,a=b.products,v=(0,i.useRouter)(),l=(0,h.useState)(v.query.page||1),o=l[0],z=l[1],p=(0,h.useState)(!1),A=p[0],B=p[1],q=(0,h.useState)(!1),w=q[0],C=q[1],r=(0,h.useState)(!0),x=r[0],D=r[1],E=(0,j.I0)();(0,h.useEffect)(function(){s&&E({type:"ADD_PRODUCT",payload:s})},[s]),(0,h.useEffect)(function(){a.filter(function(a){return a.checked}).length>0?D(!1):D(!0)},[a]),(0,h.useEffect)(function(){F()},[a]);var F=function(){a.filter(function(a){return!a.checked}).length>0?C(!1):C(!0)},G=function(b,a){"next"===a.direc?(k({router:v,page:o+1}),z(o+1)):o>1&&(z(o-1),k({router:v,page:o-1}))};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{className:"container",children:[(0,g.jsx)(n,{categories:u}),(0,g.jsxs)("span",{className:"p-2 align-items-center justify-content-center bg-danger",children:[(0,g.jsx)("input",{type:"checkbox",checked:w,onChange:function(){var b=[];a.forEach(function(a){return b.push((0,e.Z)((0,d.Z)({},a),{checked:!A}))}),E({type:"ADD_PRODUCT",payload:b}),B(!A),C(!w)}}),(0,g.jsx)("button",{className:"btn btn-danger",onClick:function(){var b=a.filter(function(a){return a.checked}).map(function(a){return a._id});E({type:"MODAL",payload:{state:a,item:(0,f.Z)(b),actionType:"ADD_PRODUCT",auth:y}})},style:{padding:"1px 1px"},"data-toggle":"modal","data-target":"#exampleModal",disabled:x,children:"delete all"})]})]}),(0,g.jsxs)("div",{className:"products_list",children:[!a&&(0,g.jsx)("h2",{children:"there is no product"}),a&&a.map(function(a){return(0,g.jsx)(m,{product:a},a._id)})]}),(0,g.jsx)("nav",{"aria-label":"Page navigation example",className:"d-flex justify-content-end mx-3",children:(0,g.jsxs)("ul",{className:"pagination d-flex flex-row-reverse",children:[(0,g.jsx)("li",{className:"page-item ".concat(1===o&&"disabled"),children:(0,g.jsx)("a",{className:"page-link",href:"#",onClick:function(a){return G(a,{direc:"prev"})},children:"Previous"})}),(0,g.jsx)("li",{className:"page-item",children:(0,g.jsx)("a",{className:"page-link",href:"#",children:o})}),(0,g.jsx)("li",{className:"page-item ".concat(!t&&"disabled"),children:(0,g.jsx)("a",{className:"page-link",href:"#",onClick:function(a){return G(a,{direc:"next"})},children:"Next"})})]})})]})}}},function(a){a.O(0,[774,888,179],function(){var b;return a(a.s=5557)}),_N_E=a.O()}])