(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[187],{9480:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile/orders/[id]",function(){return c(841)}])},841:function(d,b,a){"use strict";a.r(b),a.d(b,{default:function(){return o}});var e=a(7568),f=a(6042),g=a(9396),c=a(4051),h=a.n(c),i=a(5893),j=a(9473),k=a(843),l=a(7294),m=a(1163),n=a(5014);function o(){var c=(0,j.v9)(function(a){return a}),o=c.orders,b=c.auth,u=(0,j.I0)(),p=(0,m.useRouter)(),v=p.query.id,d=(0,l.useState)(null),a=d[0],w=d[1];if((0,l.useEffect)(function(){if(o){var a=o.filter(function(a){return a._id===v});a||p.push("/404"),w(a[0])}},[o]),!b.user)return null;var q,r,s=(q=(0,e.Z)(h().mark(function c(){var d,e;return h().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,k.B6)("/orders/".concat(a._id),null,b.access_token);case 2:return d=c.sent,c.next=5,d.json();case 5:if(!(e=c.sent).error){c.next=8;break}return c.abrupt("return",u({type:"NOTIFY",payload:e}));case 8:return u((0,n.$G)(o,a._id,(0,g.Z)((0,f.Z)({},a),{paid:e.data.paid,paidAt:e.data.paidAt}),"ADD_ORDERS")),c.abrupt("return",u({type:"NOTIFY",payload:{success:e.message}}));case 10:case"end":return c.stop()}},c)})),function(){return q.apply(this,arguments)}),t=(r=(0,e.Z)(h().mark(function c(){var d,e;return h().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return u({type:"NOTIFY",payload:{loading:"please wait..."}}),c.next=3,(0,k.B6)("/orders/delivered/".concat(a._id),null,b.access_token);case 3:return d=c.sent,c.next=6,d.json();case 6:if(!(e=c.sent).error){c.next=9;break}return c.abrupt("return",u({type:"NOTIFY",payload:e}));case 9:u({type:"NOTIFY",payload:{success:"order updated"}}),a.paid?u((0,n.$G)(o,a._id,(0,g.Z)((0,f.Z)({},a),{delivered:!0}))):u((0,n.$G)(o,a._id,(0,g.Z)((0,f.Z)({},a),{paid:!0,paidAt:e.data.paidAt,delivered:!0,method:e.data.method})));case 11:case"end":return c.stop()}},c)})),function(){return r.apply(this,arguments)});return(0,i.jsxs)("div",{className:"container d-flex justify-content-around",children:[(0,i.jsx)("div",{className:"details my-4",children:a&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h1",{className:"mb-3",children:a._id}),(0,i.jsx)("h3",{children:"shipping"}),(0,i.jsxs)("ul",{style:{listStyle:"none"},children:[(0,i.jsxs)("li",{children:["Address : ",a.address]}),(0,i.jsxs)("li",{children:["Telephone : ",a.telephone]}),(0,i.jsxs)("li",{children:["User ID : ",a.user]})]}),(0,i.jsxs)("div",{className:"alert ".concat(a.delivered?"alert-success":"alert-danger"," d-flex justify-content-between align-items-center"),children:[a.delivered?"delivered":"not delivered","admin"===b.user.role&&b.user.root&&!a.delivered&&(0,i.jsx)("button",{className:"btn btn-secondary",onClick:t,children:"MARK AS DELIVERED"})]}),(0,i.jsx)("div",{className:"alert ".concat(a.paid?"alert-success":"alert-danger"),children:a.paid?"paid at ".concat(a.paidAt):"not paid"}),(0,i.jsx)("h3",{children:"cart: "}),(0,i.jsx)("div",{className:"table-responsive",children:(0,i.jsx)("table",{className:"table-bordered w-100",children:(0,i.jsx)("tbody",{children:a&&a.cart.map(function(a){return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:"p-1",children:(0,i.jsx)("img",{className:"img-thumbnail w-100",style:{height:"80px",maxWidth:"80px"},src:a.images[0].url,alt:a.images[0].url})}),(0,i.jsxs)("td",{className:"p-1",children:[(0,i.jsx)("h6",{className:"text-danger text-capitalize",children:a.title}),(0,i.jsxs)("h6",{children:[a.quantity," x ",a.price," = ",a.quantity*a.price," $"]})]})]},a._id)})})})})]})}),a&&!a.paid&&b.user&&"admin"!==b.user.role&&(0,i.jsxs)("div",{className:"payment-button p-4",children:[(0,i.jsx)("h2",{children:"payment: "}),(0,i.jsx)("button",{className:"btn btn-primary",onClick:s,children:"PayPal"})]})]})}}},function(a){a.O(0,[774,888,179],function(){var b;return a(a.s=9480)}),_N_E=a.O()}])