(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[190],{8086:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cart",function(){return c(1711)}])},1711:function(g,b,a){"use strict";a.r(b),a.d(b,{default:function(){return f}});var h=a(7568),i=a(4924),j=a(6042),k=a(9396),l=a(797),c=a(4051),m=a.n(c),n=a(5893),o=a(2645),d=a(5675),p=a.n(d),e=a(9008),q=a.n(e),r={src:"/_next/static/media/empty-cart.6e329bd9.png",height:2049,width:2601,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAGCAYAAAD+Bd/7AAAAsUlEQVR42mNABu/fPRf5/O2zAoh95e0PRrjE+lNXvK+9eHd8x6W7T+fsPvn59pvPZ249exUMlrz18JHAjRfvJp+5dv3/3t2b/m/cuOr/2fOn/994/mbas9ev2MGKLr/4mH/j5pX/r5bb/3+3VOb/s0Nz/p9/8bkBbsWt56/zLj1+efH81cv3Ll8+d/fKvfsPrjx9EwhXcO3pKw4wY/87IYZ9PwQldj/m/f//PxMDAwMDAK3nZZNoIINsAAAAAElFTkSuQmCC"},s=a(9473),t=a(5014);function u(b){var a=b.item,c=(0,s.v9)(function(a){return a.cart}),d=(0,s.I0)();return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("tr",{style:{borderTop:"1px solid black"},children:[(0,n.jsx)("td",{style:{width:"100px",overflow:"hidden"},children:(0,n.jsx)("img",{src:a.images[0].url,alt:a.images[0].url,className:" w-100 img-thumbnail",style:{minWidth:"80px",height:"80px"}})}),(0,n.jsxs)("td",{style:{minWidth:"200px",textAlign:"center"},children:[(0,n.jsxs)("h5",{className:"text-capitalize",children:[a.title," "]}),(0,n.jsxs)("h6",{className:"text-danger",children:["$ ",a.quantity*a.price]}),(0,n.jsxs)("h6",{className:"text-danger",children:["inStock : ",a.inStock]})]}),(0,n.jsxs)("td",{style:{minWidth:"200px",textAlign:"center"},children:[(0,n.jsx)("button",{onClick:function(){return d((0,t.dx)(c,a._id))},className:"btn btn-outlined",disabled:1===a.quantity,children:" - "}),(0,n.jsxs)("span",{className:"px-2",children:[" ",a.quantity," "]}),(0,n.jsx)("button",{onClick:function(){return d((0,t.pE)(c,a._id))},className:"btn btn-outlined",disabled:a.quantity===a.inStock,children:" + "})]}),(0,n.jsx)("td",{children:(0,n.jsx)("i",{"data-toggle":"modal","data-target":"#exampleModal",onClick:function(){return d({type:"MODAL",payload:{item:a,type:"delete"}})},className:"btn btn-danger fas fa-trash-alt"})})]})})}var v=a(8757),w=a(8074),x=a(1163),y=a(7294),z=a(3739),A=a(843);function f(){var e=(0,y.useState)({address:"",email:"",telephone:""}),b=e[0],D=e[1],E=b.address,F=b.email,G=b.telephone,f=(0,y.useState)(1),o=f[0],H=f[1],g=(0,y.useState)(!1),t=g[0],I=g[1],a=(0,s.v9)(function(a){return a}),c=a.cart,J=a.auth,v=a.notify,K=a.orders,w=(0,s.I0)(),L=(0,x.useRouter)();if((0,y.useEffect)(function(){var a=JSON.parse(localStorage.getItem("nextCart"));if(a&&a.length>0){var b,c=[];(b=(0,h.Z)(m().mark(function b(){var d,e,f,g,h,i,j,k,l,n,o,p,q,r;return m().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:d=!0,e=!1,f=void 0,b.prev=1,g=a[Symbol.iterator]();case 3:if(d=(h=g.next()).done){b.next=21;break}return i=h.value,b.next=7,(0,A.Yu)("/products/".concat(i._id));case 7:return j=b.sent,b.next=10,j.json();case 10:l=(k=b.sent)._id,n=k.title,o=k.images,p=k.price,q=k.inStock,r=k.sold,q>0&&c.push({_id:l,title:n,price:p,images:o,inStock:q,sold:r,quantity:i.quantity>q?1:i.quantity});case 18:d=!0,b.next=3;break;case 21:b.next=27;break;case 23:b.prev=23,b.t0=b.catch(1),e=!0,f=b.t0;case 27:b.prev=27,b.prev=28,d||null==g.return||g.return();case 30:if(b.prev=30,!e){b.next=33;break}throw f;case 33:return b.finish(30);case 34:return b.finish(27);case 35:w({type:"ADD_CART",payload:c});case 37:case"end":return b.stop()}},b,null,[[1,23,27,35],[28,,30,34]])})),function(){return b.apply(this,arguments)})()}},[t,w]),(0,y.useEffect)(function(){H(c.reduce(function(b,a){return b+a.quantity*a.price},0))},[c]),0===c.length)return(0,n.jsx)("div",{className:"container",children:(0,n.jsx)(p(),{placeholder:"blur",src:r,alt:"",style:{width:"100%"}})});var B,d=function(c){var a=c.target,d=a.name,e=a.value;D((0,k.Z)((0,j.Z)({},b),(0,i.Z)({},d,e)))},C=(B=(0,h.Z)(m().mark(function a(){var d,e,f,g,h,i,n,p,q,r,s,u;return m().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(J.user||L.push("/signin"),!(d=(0,z.AD)(E,F,G))){a.next=4;break}return a.abrupt("return",w({type:"NOTIFY",payload:{error:d}}));case 4:e=[],f=!0,g=!1,h=void 0,a.prev=6,i=c[Symbol.iterator]();case 8:if(f=(n=i.next()).done){a.next=20;break}return p=n.value,a.next=12,(0,A.Yu)("/products/".concat(p._id));case 12:return q=a.sent,a.next=15,q.json();case 15:(r=a.sent).inStock-p.quantity>=0&&e.push(p);case 17:f=!0,a.next=8;break;case 20:a.next=26;break;case 22:a.prev=22,a.t0=a.catch(6),g=!0,h=a.t0;case 26:a.prev=26,a.prev=27,f||null==i.return||i.return();case 29:if(a.prev=29,!g){a.next=32;break}throw h;case 32:return a.finish(29);case 33:return a.finish(26);case 34:if(!(e.length<c.length)){a.next=37;break}return I(!t),a.abrupt("return",w({type:"NOTIFY",payload:{error:"item out of stock"}}));case 37:return a.next=39,(0,A.qC)("/orders",(0,k.Z)((0,j.Z)({},b),{cart:c,total:o}),J.access_token);case 39:return s=a.sent,a.next=42,s.json();case 42:if(!(u=a.sent).error){a.next=45;break}return a.abrupt("return",w({type:"NOTIFY",payload:u}));case 45:w({type:"NOTIFY",payload:{success:"order confirmed wait for our call!"}}),w({type:"ADD_CART",payload:[]}),w({type:"ADD_ORDERS",payload:(0,l.Z)(K).concat([u])}),L.push("/profile/orders/".concat(u._id));case 49:case"end":return a.stop()}},a,null,[[6,22,26,34],[27,,29,33]])})),function(){return B.apply(this,arguments)});return(0,n.jsxs)("div",{className:"cart container",children:[(0,n.jsx)(q(),{children:(0,n.jsx)("title",{children:"cart"})}),(0,n.jsxs)("div",{className:"row",children:[(0,n.jsx)("div",{className:"col-md-8 my-3 table-responsive",children:(0,n.jsx)("table",{children:(0,n.jsx)("tbody",{children:c.map(function(a,b){return(0,n.jsx)(u,{item:a},b)})})})}),(0,n.jsxs)("div",{className:"col-md-4 my-3",children:[(0,n.jsx)("h6",{children:"Shiping"}),(0,n.jsxs)("div",{className:"form",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"addressInp",children:"Address : "}),(0,n.jsx)("input",{type:"text",id:"addressInp",onChange:d,name:"address",className:"form-control"})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"telephoneInp",children:"telephone : "}),(0,n.jsx)("input",{type:"text",id:"telephoneInp",onChange:d,name:"telephone",className:"form-control"})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"emailInp",children:"email : "}),(0,n.jsx)("input",{type:"text",id:"emailInp",name:"email",onChange:d,className:"form-control"})]}),(0,n.jsxs)("h4",{className:"text-secondary",children:["Total : $",o]}),(0,n.jsx)("button",{className:"btn btn-secondary",disabled:v.loading,onClick:C,children:"PROCEED WITH PAYMENT"})]})]})]})]})}a(841),f.getLayout=function(a){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.Z,{}),(0,n.jsx)(w.Z,{}),(0,n.jsx)(v.Z,{}),a]})}},841:function(d,b,a){"use strict";a.r(b),a.d(b,{default:function(){return o}});var e=a(7568),f=a(6042),g=a(9396),c=a(4051),h=a.n(c),i=a(5893),j=a(9473),k=a(843),l=a(7294),m=a(1163),n=a(5014);function o(){var c=(0,j.v9)(function(a){return a}),o=c.orders,b=c.auth,u=(0,j.I0)(),p=(0,m.useRouter)(),v=p.query.id,d=(0,l.useState)(null),a=d[0],w=d[1];if((0,l.useEffect)(function(){if(o){var a=o.filter(function(a){return a._id===v});a||p.push("/404"),w(a[0])}},[o]),!b.user)return null;var q,r,s=(q=(0,e.Z)(h().mark(function c(){var d,e;return h().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,k.B6)("/orders/".concat(a._id),null,b.access_token);case 2:return d=c.sent,c.next=5,d.json();case 5:if(!(e=c.sent).error){c.next=8;break}return c.abrupt("return",u({type:"NOTIFY",payload:e}));case 8:return u((0,n.$G)(o,a._id,(0,g.Z)((0,f.Z)({},a),{paid:e.data.paid,paidAt:e.data.paidAt}),"ADD_ORDERS")),c.abrupt("return",u({type:"NOTIFY",payload:{success:e.message}}));case 10:case"end":return c.stop()}},c)})),function(){return q.apply(this,arguments)}),t=(r=(0,e.Z)(h().mark(function c(){var d,e;return h().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return u({type:"NOTIFY",payload:{loading:"please wait..."}}),c.next=3,(0,k.B6)("/orders/delivered/".concat(a._id),null,b.access_token);case 3:return d=c.sent,c.next=6,d.json();case 6:if(!(e=c.sent).error){c.next=9;break}return c.abrupt("return",u({type:"NOTIFY",payload:e}));case 9:u({type:"NOTIFY",payload:{success:"order updated"}}),a.paid?u((0,n.$G)(o,a._id,(0,g.Z)((0,f.Z)({},a),{delivered:!0}))):u((0,n.$G)(o,a._id,(0,g.Z)((0,f.Z)({},a),{paid:!0,paidAt:e.data.paidAt,delivered:!0,method:e.data.method})));case 11:case"end":return c.stop()}},c)})),function(){return r.apply(this,arguments)});return(0,i.jsxs)("div",{className:"container d-flex justify-content-around",children:[(0,i.jsx)("div",{className:"details my-4",children:a&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h1",{className:"mb-3",children:a._id}),(0,i.jsx)("h3",{children:"shipping"}),(0,i.jsxs)("ul",{style:{listStyle:"none"},children:[(0,i.jsxs)("li",{children:["Address : ",a.address]}),(0,i.jsxs)("li",{children:["Telephone : ",a.telephone]}),(0,i.jsxs)("li",{children:["User ID : ",a.user]})]}),(0,i.jsxs)("div",{className:"alert ".concat(a.delivered?"alert-success":"alert-danger"," d-flex justify-content-between align-items-center"),children:[a.delivered?"delivered":"not delivered","admin"===b.user.role&&b.user.root&&!a.delivered&&(0,i.jsx)("button",{className:"btn btn-secondary",onClick:t,children:"MARK AS DELIVERED"})]}),(0,i.jsx)("div",{className:"alert ".concat(a.paid?"alert-success":"alert-danger"),children:a.paid?"paid at ".concat(a.paidAt):"not paid"}),(0,i.jsx)("h3",{children:"cart: "}),(0,i.jsx)("div",{className:"table-responsive",children:(0,i.jsx)("table",{className:"table-bordered w-100",children:(0,i.jsx)("tbody",{children:a&&a.cart.map(function(a){return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:"p-1",children:(0,i.jsx)("img",{className:"img-thumbnail w-100",style:{height:"80px",maxWidth:"80px"},src:a.images[0].url,alt:a.images[0].url})}),(0,i.jsxs)("td",{className:"p-1",children:[(0,i.jsx)("h6",{className:"text-danger text-capitalize",children:a.title}),(0,i.jsxs)("h6",{children:[a.quantity," x ",a.price," = ",a.quantity*a.price," $"]})]})]},a._id)})})})})]})}),a&&!a.paid&&b.user&&"admin"!==b.user.role&&(0,i.jsxs)("div",{className:"payment-button p-4",children:[(0,i.jsx)("h2",{children:"payment: "}),(0,i.jsx)("button",{className:"btn btn-primary",onClick:s,children:"PayPal"})]})]})}},3739:function(c,a,b){"use strict";b.d(a,{AD:function(){return g},Nj:function(){return f},P0:function(){return d}});var d=function(b,a,c){return b&&a&&c?e(b)?a.length<6?"password must be at least 6 characters":a!==c?"passwords are not the same":void 0:"email is invalid":"please add all fields!"},e=function(a){return String(a).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)},f=function(a,b){return a&&b?e(a)?b.length<6?"password must be at least 6 characters":void 0:"email is invalid":"please add all fields!"},g=function(b,a,c){return a&&b&&c?e(a)?void 0:"email is invalid":"please add all fields!"}}},function(a){a.O(0,[959,774,888,179],function(){var b;return a(a.s=8086)}),_N_E=a.O()}])